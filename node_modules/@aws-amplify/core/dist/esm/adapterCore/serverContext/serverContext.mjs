import { serverContextRegistry } from './serverContextRegistry.mjs';
import { AmplifyClass } from '../../singleton/Amplify.mjs';

// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0
/**
 * Creates an Amplify server context.
 * @param amplifyConfig The Amplify resource config.
 * @param libraryOptions The Amplify library options.
 * @returns The Amplify server context spec.
 */
const createAmplifyServerContext = (amplifyConfig, libraryOptions) => {
    const amplify = new AmplifyClass();
    amplify.configure(amplifyConfig, libraryOptions);
    return serverContextRegistry.register({
        amplify,
    });
};
/**
 * Returns an Amplify server context.
 * @param contextSpec The context spec used to get the Amplify server context.
 * @returns The Amplify server context.
 */
const getAmplifyServerContext = (contextSpec) => {
    const context = serverContextRegistry.get(contextSpec);
    if (context) {
        return context;
    }
    throw new Error('Attempted to get the Amplify Server Context that may have been destroyed.');
};
/**
 * Destroys an Amplify server context.
 * @param contextSpec The context spec used to destroy the Amplify server context.
 */
const destroyAmplifyServerContext = (contextSpec) => {
    serverContextRegistry.deregister(contextSpec);
};

export { createAmplifyServerContext, destroyAmplifyServerContext, getAmplifyServerContext };
//# sourceMappingURL=serverContext.mjs.map
