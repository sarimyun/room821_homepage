{"ast":null,"code":"import { ConsoleLogger } from '@aws-amplify/core';\nimport { assertIdentityPoolIdConfig } from '@aws-amplify/core/internals/utils';\nimport { IdentityIdStorageKeys } from './types.mjs';\nimport { getAuthStorageKeys } from '../tokenProvider/TokenStore.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst logger = new ConsoleLogger('DefaultIdentityIdStore');\nclass DefaultIdentityIdStore {\n  setAuthConfig(authConfigParam) {\n    assertIdentityPoolIdConfig(authConfigParam.Cognito);\n    this.authConfig = authConfigParam;\n    this._authKeys = createKeysForAuthStorage('Cognito', authConfigParam.Cognito.identityPoolId);\n    return;\n  }\n  constructor(keyValueStorage) {\n    this._authKeys = {};\n    this.keyValueStorage = keyValueStorage;\n  }\n  async loadIdentityId() {\n    var _this$authConfig;\n    assertIdentityPoolIdConfig((_this$authConfig = this.authConfig) === null || _this$authConfig === void 0 ? void 0 : _this$authConfig.Cognito);\n    try {\n      if (!!this._primaryIdentityId) {\n        return {\n          id: this._primaryIdentityId,\n          type: 'primary'\n        };\n      } else {\n        const storedIdentityId = await this.keyValueStorage.getItem(this._authKeys.identityId);\n        if (!!storedIdentityId) {\n          return {\n            id: storedIdentityId,\n            type: 'guest'\n          };\n        }\n        return null;\n      }\n    } catch (err) {\n      logger.log('Error getting stored IdentityId.', err);\n      return null;\n    }\n  }\n  async storeIdentityId(identity) {\n    var _this$authConfig2;\n    assertIdentityPoolIdConfig((_this$authConfig2 = this.authConfig) === null || _this$authConfig2 === void 0 ? void 0 : _this$authConfig2.Cognito);\n    if (identity.type === 'guest') {\n      this.keyValueStorage.setItem(this._authKeys.identityId, identity.id);\n      // Clear in-memory storage of primary identityId\n      this._primaryIdentityId = undefined;\n    } else {\n      this._primaryIdentityId = identity.id;\n      // Clear locally stored guest id\n      this.keyValueStorage.removeItem(this._authKeys.identityId);\n    }\n  }\n  async clearIdentityId() {\n    this._primaryIdentityId = undefined;\n    await this.keyValueStorage.removeItem(this._authKeys.identityId);\n  }\n}\nconst createKeysForAuthStorage = (provider, identifier) => {\n  return getAuthStorageKeys(IdentityIdStorageKeys)(\"com.amplify.\".concat(provider), identifier);\n};\nexport { DefaultIdentityIdStore };","map":{"version":3,"names":["logger","ConsoleLogger","DefaultIdentityIdStore","setAuthConfig","authConfigParam","assertIdentityPoolIdConfig","Cognito","authConfig","_authKeys","createKeysForAuthStorage","identityPoolId","constructor","keyValueStorage","loadIdentityId","_this$authConfig","_primaryIdentityId","id","type","storedIdentityId","getItem","identityId","err","log","storeIdentityId","identity","_this$authConfig2","setItem","undefined","removeItem","clearIdentityId","provider","identifier","getAuthStorageKeys","IdentityIdStorageKeys","concat"],"sources":["/Users/sarimyun/react-native-app/room821_homepage/room821_homepage/node_modules/@aws-amplify/auth/src/providers/cognito/credentialsProvider/IdentityIdStore.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { ConsoleLogger, } from '@aws-amplify/core';\nimport { assertIdentityPoolIdConfig } from '@aws-amplify/core/internals/utils';\nimport { IdentityIdStorageKeys } from './types';\nimport { getAuthStorageKeys } from '../tokenProvider/TokenStore';\nconst logger = new ConsoleLogger('DefaultIdentityIdStore');\nexport class DefaultIdentityIdStore {\n    setAuthConfig(authConfigParam) {\n        assertIdentityPoolIdConfig(authConfigParam.Cognito);\n        this.authConfig = authConfigParam;\n        this._authKeys = createKeysForAuthStorage('Cognito', authConfigParam.Cognito.identityPoolId);\n        return;\n    }\n    constructor(keyValueStorage) {\n        this._authKeys = {};\n        this.keyValueStorage = keyValueStorage;\n    }\n    async loadIdentityId() {\n        assertIdentityPoolIdConfig(this.authConfig?.Cognito);\n        try {\n            if (!!this._primaryIdentityId) {\n                return {\n                    id: this._primaryIdentityId,\n                    type: 'primary',\n                };\n            }\n            else {\n                const storedIdentityId = await this.keyValueStorage.getItem(this._authKeys.identityId);\n                if (!!storedIdentityId) {\n                    return {\n                        id: storedIdentityId,\n                        type: 'guest',\n                    };\n                }\n                return null;\n            }\n        }\n        catch (err) {\n            logger.log('Error getting stored IdentityId.', err);\n            return null;\n        }\n    }\n    async storeIdentityId(identity) {\n        assertIdentityPoolIdConfig(this.authConfig?.Cognito);\n        if (identity.type === 'guest') {\n            this.keyValueStorage.setItem(this._authKeys.identityId, identity.id);\n            // Clear in-memory storage of primary identityId\n            this._primaryIdentityId = undefined;\n        }\n        else {\n            this._primaryIdentityId = identity.id;\n            // Clear locally stored guest id\n            this.keyValueStorage.removeItem(this._authKeys.identityId);\n        }\n    }\n    async clearIdentityId() {\n        this._primaryIdentityId = undefined;\n        await this.keyValueStorage.removeItem(this._authKeys.identityId);\n    }\n}\nconst createKeysForAuthStorage = (provider, identifier) => {\n    return getAuthStorageKeys(IdentityIdStorageKeys)(`com.amplify.${provider}`, identifier);\n};\n"],"mappings":";;;;;AAAA;AACA;AAKA,MAAMA,MAAM,GAAG,IAAIC,aAAa,CAAC,wBAAwB,CAAC;AACnD,MAAMC,sBAAsB,CAAC;EAChCC,aAAaA,CAACC,eAAe,EAAE;IAC3BC,0BAA0B,CAACD,eAAe,CAACE,OAAO,CAAC;IACnD,IAAI,CAACC,UAAU,GAAGH,eAAe;IACjC,IAAI,CAACI,SAAS,GAAGC,wBAAwB,CAAC,SAAS,EAAEL,eAAe,CAACE,OAAO,CAACI,cAAc,CAAC;IAC5F;EACR;EACIC,WAAWA,CAACC,eAAe,EAAE;IACzB,IAAI,CAACJ,SAAS,GAAG,EAAE;IACnB,IAAI,CAACI,eAAe,GAAGA,eAAe;EAC9C;EACI,MAAMC,cAAcA,CAAA,EAAG;IAAA,IAAAC,gBAAA;IACnBT,0BAA0B,EAAAS,gBAAA,GAAC,IAAI,CAACP,UAAU,cAAAO,gBAAA,uBAAfA,gBAAA,CAAiBR,OAAO,CAAC;IACpD,IAAI;MACA,IAAI,CAAC,CAAC,IAAI,CAACS,kBAAkB,EAAE;QAC3B,OAAO;UACHC,EAAE,EAAE,IAAI,CAACD,kBAAkB;UAC3BE,IAAI,EAAE;QAC1B,CAAiB;MACjB,CAAa,MACI;QACD,MAAMC,gBAAgB,GAAG,MAAM,IAAI,CAACN,eAAe,CAACO,OAAO,CAAC,IAAI,CAACX,SAAS,CAACY,UAAU,CAAC;QACtF,IAAI,CAAC,CAACF,gBAAgB,EAAE;UACpB,OAAO;YACHF,EAAE,EAAEE,gBAAgB;YACpBD,IAAI,EAAE;UAC9B,CAAqB;QACrB;QACgB,OAAO,IAAI;MAC3B;IACA,CAAS,CACD,OAAOI,GAAG,EAAE;MACRrB,MAAM,CAACsB,GAAG,CAAC,kCAAkC,EAAED,GAAG,CAAC;MACnD,OAAO,IAAI;IACvB;EACA;EACI,MAAME,eAAeA,CAACC,QAAQ,EAAE;IAAA,IAAAC,iBAAA;IAC5BpB,0BAA0B,EAAAoB,iBAAA,GAAC,IAAI,CAAClB,UAAU,cAAAkB,iBAAA,uBAAfA,iBAAA,CAAiBnB,OAAO,CAAC;IACpD,IAAIkB,QAAQ,CAACP,IAAI,KAAK,OAAO,EAAE;MAC3B,IAAI,CAACL,eAAe,CAACc,OAAO,CAAC,IAAI,CAAClB,SAAS,CAACY,UAAU,EAAEI,QAAQ,CAACR,EAAE,CAAC;MAChF;MACY,IAAI,CAACD,kBAAkB,GAAGY,SAAS;IAC/C,CAAS,MACI;MACD,IAAI,CAACZ,kBAAkB,GAAGS,QAAQ,CAACR,EAAE;MACjD;MACY,IAAI,CAACJ,eAAe,CAACgB,UAAU,CAAC,IAAI,CAACpB,SAAS,CAACY,UAAU,CAAC;IACtE;EACA;EACI,MAAMS,eAAeA,CAAA,EAAG;IACpB,IAAI,CAACd,kBAAkB,GAAGY,SAAS;IACnC,MAAM,IAAI,CAACf,eAAe,CAACgB,UAAU,CAAC,IAAI,CAACpB,SAAS,CAACY,UAAU,CAAC;EACxE;AACA;AACA,MAAMX,wBAAwB,GAAGA,CAACqB,QAAQ,EAAEC,UAAU,KAAK;EACvD,OAAOC,kBAAkB,CAACC,qBAAqB,CAAC,gBAAAC,MAAA,CAAgBJ,QAAQ,GAAIC,UAAU,CAAC;AAC3F,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}